#!/bin/sh
set -e

echo "pre-commit: running gofmt check..."
unformatted=$(gofmt -l .)
if [ -n "$unformatted" ]; then
  echo "gofmt formatting issues found in:" 
  echo "$unformatted"
  echo "Run 'gofmt -w .' to format files. Aborting commit."
  exit 1
fi

echo "pre-commit: running go vet..."
go vet ./...

echo "pre-commit: running go test..."
go test ./...

echo "pre-commit: checks passed."
exit 0
